* * *

title: 外部サービスの追加 layout: rancher-default-v1.3 version: v1.3 lang: ja

* * *

## ## 外部サービスの追加

Rancher の外部で稼働しているサービスを Rancher と統合することが出来ます。外部サービスの追加機能を使えば Rancher にサービスを追加できます。

### UI を使った外部サービスの追加

スタック画面の中の、**サービスを追加**ボタンを押すと出てくるドロップダウンから外部サービスを追加します。 **外部サービスを追加**を選択してください。 あるいは、スタック一覧画面を見てる場合でも、同様の**サービスの追加**ドロップダウンがスタックごとに表示されます。 

サービスの**名前** は必須で、必要であれば**詳細情報**を入力してください。

必要なターゲットを追加します。外部のIPアドレスかホスト名（CNAME等）を選べます。最後に**作成**をクリックしてください。

外部サービスのIPアドレスとホスト名がサービス画面に表示されるようになります。他のサービスと同様に外部サービスを起動する必要があります。

#### ターゲットの追加/削除

外部サービスへのターゲット追加はいつでも可能です。 外部サービスのドロップダウンメニューから**作成**をクリックします。 ターゲットを追加したり、既存のターゲットを削除したりできるでしょう。

### Rancher Compose での外部サービス追加

外部サービスに関しては、 外部のIPアドレス**もしくは**ホスト名を設定できます。 `rancher/external-service` は実際のイメージではありませんが `docker-compose.yml` に記載する必要があります。 外部サービスのために作られたコンテナーではありません。

#### `docker-compose.yml` の例

```yaml
version: '2'
services:
  db:
    image: rancher/external-service
  redis:
    image: redis
```

#### 外部のIPアドレスを使った `rancher-compose.yml` の例 

```yaml
version: '2'
services:
  db:
    external_ips:
    - 1.1.1.1
    - 2.2.2.2

  # 任意のサービスをオーバライドして外部サービスにする
  redis:
    image: redis
    external_ips:
    - 1.1.1.1
    - 2.2.2.2
```

#### ホスト名を使った `rancher-compose.yml` の例 

```yaml
version: '2'
services:
  db:
    hostname: example.com
```